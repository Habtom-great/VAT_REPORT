<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>VAT Refund Form</title>
  <style>
    :root {
      --primary-color: #2c3e50;
      --secondary-color: #3498db;
      --accent-color: #e74c3c;
      --success-color: #27ae60;
      --light-gray: #f8f9fa;
      --medium-gray: #e9ecef;
      --dark-gray: #6c757d;
      --border-color: #dee2e6;
    }
    
    * {
      box-sizing: border-box;
      margin: 0;
      padding: 0;
    }
    
    body {
      font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
      margin: 0;
      padding: 0;
      color: #333;
      line-height: 1.6;
      background-color: #f5f7fa;
      height: 100vh;
      display: flex;
      flex-direction: column;
    }
    
    .container {
      flex: 1;
      width: 100%;
      margin: 0;
      background-color: white;
      padding: 15px;
      overflow-y: auto;
    }
    
    .header {
      text-align: center;
      margin-bottom: 15px;
      padding-bottom: 10px;
      border-bottom: 2px solid var(--primary-color);
    }
    
    .header h2 {
      color: var(--primary-color);
      margin-bottom: 5px;
      font-size: 1.5rem;
    }
    
    .header h3 {
      color: var(--secondary-color);
      margin-top: 5px;
      font-weight: 500;
      font-size: 1.1rem;
    }
    
    .form-section {
      margin-bottom: 15px;
      padding: 15px;
      background-color: var(--light-gray);
      border-radius: 6px;
    }
    
    .form-section-title {
      font-weight: 600;
      color: var(--primary-color);
      margin-bottom: 10px;
      font-size: 1.1rem;
      border-bottom: 1px solid var(--border-color);
      padding-bottom: 5px;
    }
    
    .form-group {
      margin-bottom: 10px;
      display: flex;
      flex-wrap: wrap;
      gap: 10px;
    }
    
    .form-field {
      flex: 1;
      min-width: 150px;
    }
    
    label {
      display: block;
      margin-bottom: 3px;
      font-weight: 500;
      color: var(--dark-gray);
      font-size: 0.9rem;
    }
    
    input, select {
      width: 100%;
      padding: 6px 10px;
      border: 1px solid var(--border-color);
      border-radius: 4px;
      font-size: 0.9rem;
      transition: border-color 0.3s;
    }
    
    input:focus, select:focus {
      outline: none;
      border-color: var(--secondary-color);
      box-shadow: 0 0 0 2px rgba(52, 152, 219, 0.2);
    }
    
    table {
      width: 100%;
      border-collapse: collapse;
      margin: 10px 0;
      font-size: 0.8rem;
      box-shadow: 0 0 5px rgba(0, 0, 0, 0.05);
    }
    
    th {
      background-color: var(--primary-color);
      color: white;
      padding: 8px;
      text-align: left;
      font-weight: 500;
      position: sticky;
      top: 0;
    }
    
    td {
      padding: 6px 8px;
      border: 1px solid var(--border-color);
      vertical-align: middle;
    }
    
    tr:nth-child(even) {
      background-color: var(--light-gray);
    }
    
    .btn {
      padding: 6px 12px;
      border: none;
      border-radius: 4px;
      cursor: pointer;
      font-weight: 500;
      transition: all 0.3s;
      margin-right: 8px;
      font-size: 0.9rem;
    }
    
    .btn-primary {
      background-color: var(--secondary-color);
      color: white;
    }
    
    .btn-primary:hover {
      background-color: #2980b9;
    }
    
    .btn-success {
      background-color: var(--success-color);
      color: white;
    }
    
    .btn-success:hover {
      background-color: #219955;
    }
    
    .btn-danger {
      background-color: var(--accent-color);
      color: white;
    }
    
    .btn-danger:hover {
      background-color: #c0392b;
    }
    
    .action-btn {
      padding: 4px 8px;
      font-size: 0.8rem;
      margin: 1px;
    }
    
    .summary-table {
      margin-top: 15px;
    }
    
    .summary-table th {
      background-color: var(--dark-gray);
    }
    
    .signature-section {
      margin-top: 20px;
      display: flex;
      justify-content: space-between;
      flex-wrap: wrap;
      gap: 15px;
    }
    
    .signature-box {
      flex: 1;
      min-width: 200px;
      padding: 10px;
      border: 1px solid var(--border-color);
      border-radius: 6px;
      font-size: 0.9rem;
    }
    
    .notes {
      margin-top: 15px;
      padding: 10px;
      background-color: #fff8e1;
      border-left: 4px solid #ffc107;
      font-size: 0.9rem;
    }
    
    .notes strong {
      color: var(--primary-color);
    }
    
    .sticky-controls {
      position: sticky;
      bottom: 0;
      background-color: white;
      padding: 10px;
      border-top: 1px solid var(--border-color);
      display: flex;
      justify-content: center;
      z-index: 100;
    }
    
    .table-container {
      overflow-x: auto;
      max-height: 300px;
      margin-bottom: 10px;
      border: 1px solid var(--border-color);
      border-radius: 4px;
    }
    
    .registered-container {
      overflow-x: auto;
      max-height: 300px;
      margin-bottom: 10px;
      border: 1px solid var(--border-color);
      border-radius: 4px;
    }
    
    @media (max-width: 768px) {
      .form-field {
        min-width: 100%;
      }
      
      .header h2 {
        font-size: 1.3rem;
      }
      
      .header h3 {
        font-size: 1rem;
      }
      
      .signature-box {
        min-width: 100%;
      }
      
      .sticky-controls {
        flex-wrap: wrap;
      }
      
      .btn {
        margin-bottom: 5px;
      }
    }
  </style>

</head>
<body>
  <div class="container">
    <!-- Header Section -->
    <div class="header">
      <h2>Ethiopian Revenues and Customs Authority</h2>
      <h3>Value Added Tax withheld and paid by the purchaser as per directive #27/2010</h3>
      <h3>A form for requesting Value Added Tax Refund</h3>
    </div>

    <!-- Company Information Section -->
    <div class="form-section">
      <div class="form-section-title">1. Company Information</div>
      <div class="form-group">
        <div class="form-field">
          <label class="required-field">Date</label>
          <input type="date" id="formDate" value="2025-01-30" required>
        </div>
      </div>
      <div class="form-group">
        <div class="form-field">
          <label>1.1 Name of company</label>
          <input type="text" value="China State Construction Engineering Eth PLC" readonly class="readonly-input">
        </div>
        <div class="form-field">
          <label>1.2 Type of Occupation</label>
          <input type="text" value="Construction" readonly class="readonly-input">
        </div>
      </div>
      <div class="form-group">
        <div class="form-field">
          <label>1.3 Address</label>
          <input type="text" value="Addis Ababa / Bole, Woreda: 03, Kebele: 17, House No: 3/123" readonly class="readonly-input">
        </div>
      </div>
      <div class="form-group">
        <div class="form-field">
          <label>Tel No</label>
          <input type="tel" placeholder="Enter telephone number">
        </div>
        <div class="form-field">
          <label>Fax No</label>
          <input type="tel" placeholder="Enter fax number">
        </div>
      </div>
      <div class="form-group">
        <div class="form-field">
          <label>1.4 VAT No</label>
          <input type="text" value="10406290010" readonly class="readonly-input">
        </div>
        <div class="form-field">
          <label>1.5 TIN No</label>
          <input type="text" value="0045702971" readonly class="readonly-input">
        </div>
      </div>
      <div class="form-group">
        <div class="form-field">
          <label>1.6 Period For Refund - Month</label>
          <select id="month">
            <option>January</option><option>February</option><option>March</option>
            <option>April</option><option>May</option><option>June</option>
            <option>July</option><option>August</option><option>September</option>
            <option>October</option><option>November</option><option>December</option>
          </select>
        </div>
        <div class="form-field">
          <label>Year</label>
          <select id="year">
            <script>
              const thisYear = new Date().getFullYear();
              for (let y = thisYear - 5; y <= thisYear + 1; y++) {
                document.write(`<option ${y === 2025 ? 'selected' : ''}>${y}</option>`);
              }
            </script>
          </select>
        </div>
      </div>
      <div class="form-group">
        <div class="form-field">
          <label class="required-field">1.6 Period For Refund - From Date</label>
          <input type="date" id="fromDate" onchange="validateDateRange()" required>
        </div>
        <div class="form-field">
          <label class="required-field">To Date</label>
          <input type="date" id="toDate" onchange="validateDateRange()" required>
        </div>
      </div>
    </div>

    <!-- VAT Entry Section -->
    <div class="form-section">
      <div class="form-section-title">2. VAT Entry Details</div>
      <div class="table-container">
        <table id="vatTable">
          <thead>
            <tr>
              <th width="30px">#</th>
              <th width="100px">Reference</th>
              <th width="120px">Name <span class="required-field"></span></th>
              <th width="100px">Supplier Tin No.</th>
              <th width="100px">Supplier Vat No.</th>
              <th width="90px">Date of Purchase <span class="required-field"></span></th>
              <th width="90px">Vat Invoice No. <span class="required-field"></span></th>
              <th width="120px">Description</th>
              <th width="80px">Goods/Services</th>
              <th width="60px">Qty <span class="required-field"></span></th>
              <th width="80px">Price <span class="required-field"></span></th>
              <th width="100px">Total Before VAT</th>
              <th width="80px">VAT (15%)</th>
              <th width="100px">Total After VAT</th>
              <th width="60px">WHT?</th>
              <th width="90px">WHT Amount (2%)</th>
              <th width="90px">Net Pay</th>
              <th width="80px">WHT No.</th>
              <th width="80px">MOP</th>
              <th width="80px">Actions</th>
            </tr>
          </thead>
          <tbody>
            <tr>
              <td>1</td>
              <td><input type="text" class="table-input"></td>
              <td><input type="text" class="table-input" required></td>
              <td><input type="text" class="table-input"></td>
              <td><input type="text" class="table-input"></td>
              <td><input type="date" class="table-input" required></td>
              <td><input type="text" class="table-input" required></td>
              <td><input type="text" class="table-input"></td>
              <td>
                <select class="table-input">
                  <option>Goods</option>
                  <option>Services</option>
                </select>
              </td>
              <td><input type="number" step="0.01" min="0" class="table-input" oninput="calculateRow(this)" required></td>
              <td><input type="number" step="0.0001" min="0" class="table-input" oninput="calculateRow(this)" required></td>
              <td><input type="text" class="table-input" readonly></td>
              <td><input type="text" class="table-input" readonly></td>
              <td><input type="text" class="table-input" readonly></td>
              <td>
                <select class="table-input" onchange="calculateWHT(this)">
                  <option value="No">No</option>
                  <option value="Yes">Yes</option>
                </select>
              </td>
              <td><input type="text" class="table-input" readonly></td>
              <td><input type="text" class="table-input" readonly></td>
              <td><input type="text" class="table-input"></td>
              <td>
                <select class="table-input">
                  <option>Cash</option>
                  <option>Bank</option>
                  <option>Transfer</option>
                  <option>Others</option>
                </select>
              </td>
              <td>
                <button class="btn btn-primary action-btn" onclick="editRow(this)">Edit</button>
                <button class="btn btn-danger action-btn" onclick="deleteRow(this)">Del</button>
              </td>
            </tr>
          </tbody>
        </table>
      </div>
    </div>

    <!-- Summary Section -->
    <div class="form-section">
      <div class="form-section-title">2.3 Summary of VAT paid on local and foreign purchases for goods and services</div>
      <div class="table-container">
        <table class="summary-table">
          <thead>
            <tr>
              <th width="40px">S.No</th>
              <th width="150px">Accounting period (month) of declaration</th>
              <th width="120px">Type of input (purchase)</th>
              <th width="120px">VAT paid on foreign purchases</th>
              <th width="120px">VAT paid on general expenses</th>
              <th width="120px">VAT paid on local purchases</th>
              <th width="120px">Total VAT paid on purchase</th>
            </tr>
          </thead>
          <tbody>
            <tr>
              <td>1</td>
              <td>Jan, 2025</td>
              <td>Goods</td>
              <td class="text-right">-</td>
              <td class="text-right">-</td>
              <td class="text-right">50,520,485.02</td>
              <td class="text-right">50,520,485.02</td>
            </tr>
            <tr>
              <td>2</td>
              <td></td>
              <td></td>
              <td></td>
              <td></td>
              <td></td>
              <td></td>
            </tr>
          </tbody>
          <tfoot>
            <tr style="font-weight: bold;">
              <td>Total</td>
              <td></td>
              <td></td>
              <td class="text-right">-</td>
              <td class="text-right">-</td>
              <td class="text-right">50,520,485.02</td>
              <td class="text-right">50,520,485.02</td>
            </tr>
          </tfoot>
        </table>
      </div>
    </div>

    <!-- Registered List Section -->
    <div class="form-section">
      <div class="form-section-title">Registered List</div>
      <div class="registered-container">
        <table id="registeredTable">
          <thead>
            <tr>
              <th width="40px">#</th>
              <th width="100px">Reference</th>
              <th width="120px">Name</th>
              <th width="90px">Date</th>
              <th width="90px">Invoice No.</th>
              <th width="80px">Type</th>
              <th width="60px">Qty</th>
              <th width="80px">Price</th>
              <th width="100px">Total Before VAT</th>
              <th width="80px">VAT</th>
              <th width="100px">Total After VAT</th>
              <th width="90px">WHT</th>
              <th width="90px">Net Pay</th>
              <th width="80px">MOP</th>
            </tr>
          </thead>
          <tbody></tbody>
        </table>
      </div>
    </div>

    <!-- Signature Section -->
    <div class="signature-section">
      <div class="signature-box">
        <strong>Prepared By</strong><br><br>
        Name: ___________________<br><br>
        Signature: ___________________<br><br>
        Date: ___________
      </div>
      <div class="signature-box">
        <strong>Approved By</strong><br><br>
        Name: ___________________<br><br>
        Signature: ___________________<br><br>
        Date: ___________
      </div>
      <div class="signature-box">
        <strong>Seal</strong><br><br><br>
        ___________________<br><br>
      </div>
    </div>

    <!-- Notes Section -->
    <div class="notes">
      <strong>NB:</strong>
      <ol>
        <li>Original invoices for local and foreign purchases on which VAT paid</li>
        <li>Invoices on which VAT withheld</li>
        <li>Sales invoice (pad)</li>
        <li>Copy of VAT declaration for the months of the refund</li>
        <li>The form has to be filled properly and submitted in three copies</li>
      </ol>
      <p>Each copy should be stamped and signed by the official of the company.</p>
    </div>
  </div>

  <!-- Action Buttons -->
  <div class="sticky-controls">
    <button class="btn btn-primary" onclick="addRow()">Add Row</button>
    <button class="btn btn-success" onclick="saveData()">Save Data</button>
    <button class="btn btn-primary" onclick="printForm()">Print Form</button>
    <button class="btn btn-danger" onclick="clearForm()">Clear Form</button>
  </div>

  <script>
    // -------- Helpers --------
    function formatNumber(num, decimals = 2) {
      return Number(num).toLocaleString('en-US', {
        minimumFractionDigits: decimals,
        maximumFractionDigits: decimals
      });
    }
    
    function unformat(str) {
      return parseFloat((str || '').toString().replace(/,/g, '')) || 0;
    }

    // Keep all saved rows here
    const savedData = [];

    // -------- Calculations --------
    function calculateRow(input) {
      const row = input.closest('tr');
      const qty = parseFloat(row.querySelector('td:nth-child(10) input').value) || 0;
      const price = parseFloat(row.querySelector('td:nth-child(11) input').value) || 0;
      const totalBefore = qty * price;
      const vat = totalBefore * 0.15;
      const totalAfter = totalBefore + vat;

      row.querySelector('td:nth-child(12) input').value = formatNumber(totalBefore);
      row.querySelector('td:nth-child(13) input').value = formatNumber(vat);
      row.querySelector('td:nth-child(14) input').value = formatNumber(totalAfter);

      calculateWHT(row.querySelector('td:nth-child(15) select'));
    }

    function calculateWHT(select) {
      const row = select.closest('tr');
      const totalBefore = unformat(row.querySelector('td:nth-child(12) input').value);
      const totalAfter = unformat(row.querySelector('td:nth-child(14) input').value);

      let wht = 0;
      if (select.value === 'Yes') {
        wht = totalBefore * 0.02;
      }

      const netPay = totalAfter - wht;

      row.querySelector('td:nth-child(16) input').value = formatNumber(wht);
      row.querySelector('td:nth-child(17) input').value = formatNumber(netPay);
    }

    // -------- Row operations --------
    function addRow() {
      const tbody = document.querySelector('#vatTable tbody');
      const newRow = tbody.rows[0].cloneNode(true);
      
      // Clear all inputs
      newRow.querySelectorAll('input').forEach(input => {
        if (input.type !== 'button') input.value = '';
      });
      
      // Reset selects
      newRow.querySelectorAll('select').forEach(select => {
        select.selectedIndex = 0;
      });
      
      // Update row number
      const rowCount = tbody.rows.length + 1;
      newRow.cells[0].textContent = rowCount;
      
      tbody.appendChild(newRow);
      
      // Scroll to the new row
      newRow.scrollIntoView({ behavior: 'smooth', block: 'nearest' });
    }

    function deleteRow(btn) {
      const row = btn.closest('tr');
      if (document.querySelectorAll('#vatTable tbody tr').length > 1) {
        // Add animation before removing
        row.classList.add('error-row');
        setTimeout(() => {
          row.remove();
          updateRowNumbers();
        }, 500);
      } else {
        alert("You need at least one row in the table.");
      }
    }

    function editRow(btn) {
      const row = btn.closest('tr');
      const rowData = extractRowData(row);
      
      // Here you would implement your edit logic
      // For now, just an alert showing the row data
      alert('Editing row with data:\n' + JSON.stringify(rowData, null, 2));
    }

    function updateRowNumbers() {
      document.querySelectorAll('#vatTable tbody tr').forEach((row, index) => {
        row.cells[0].textContent = index + 1;
      });
    }

    // -------- Data operations --------
    function saveData() {
      const rows = document.querySelectorAll('#vatTable tbody tr');
      let hasErrors = false;
      
      // Clear previous saved data
      savedData.length = 0;
      
      rows.forEach(row => {
        const rowData = extractRowData(row);
        
        // Simple validation - check required fields
        const requiredFields = [
          row.querySelector('td:nth-child(3) input'), // Name
          row.querySelector('td:nth-child(6) input'), // Date
          row.querySelector('td:nth-child(7) input'), // Invoice
          row.querySelector('td:nth-child(10) input'), // Qty
          row.querySelector('td:nth-child(11) input')  // Price
        ];
        
        let rowHasError = false;
        requiredFields.forEach(field => {
          if (!field.value.trim()) {
            rowHasError = true;
            field.classList.add('error-row');
            setTimeout(() => field.classList.remove('error-row'), 1000);
          }
        });
        
        if (rowHasError) {
          hasErrors = true;
          row.classList.add('error-row');
          setTimeout(() => row.classList.remove('error-row'), 1000);
        } else {
          row.classList.remove('error-row');
          savedData.push(rowData);
        }
      });
      
      if (hasErrors) {
        alert('Please fill all required fields in highlighted rows before saving.');
        return;
      }
      
      if (savedData.length === 0) {
        alert('No valid data to save. Please add at least one complete row.');
        return;
      }
      
      renderRegisteredList();
      updateSummary();
      alert(`Data saved successfully! ${savedData.length} records saved.`);
    }

    function extractRowData(row) {
      return {
        reference: row.querySelector('td:nth-child(2) input').value.trim(),
        name: row.querySelector('td:nth-child(3) input').value.trim(),
        tin: row.querySelector('td:nth-child(4) input').value.trim(),
        vatNo: row.querySelector('td:nth-child(5) input').value.trim(),
        date: row.querySelector('td:nth-child(6) input').value,
        invoice: row.querySelector('td:nth-child(7) input').value.trim(),
        description: row.querySelector('td:nth-child(8) input').value.trim(),
        type: row.querySelector('td:nth-child(9) select').value,
        qty: parseFloat(row.querySelector('td:nth-child(10) input').value) || 0,
        price: parseFloat(row.querySelector('td:nth-child(11) input').value) || 0,
        totalBefore: unformat(row.querySelector('td:nth-child(12) input').value),
        vat: unformat(row.querySelector('td:nth-child(13) input').value),
        totalAfter: unformat(row.querySelector('td:nth-child(14) input').value),
        whtFlag: row.querySelector('td:nth-child(15) select').value,
        whtAmount: unformat(row.querySelector('td:nth-child(16) input').value),
        netPay: unformat(row.querySelector('td:nth-child(17) input').value),
        whtNo: row.querySelector('td:nth-child(18) input').value.trim(),
        mop: row.querySelector('td:nth-child(19) select').value
      };
    }

    function renderRegisteredList() {
      const tbody = document.querySelector('#registeredTable tbody');
      tbody.innerHTML = '';
      
      if (savedData.length === 0) {
        const emptyRow = document.createElement('tr');
        emptyRow.innerHTML = '<td colspan="14" style="text-align: center;">No registered data available</td>';
        tbody.appendChild(emptyRow);
        return;
      }
      
      savedData.forEach((data, index) => {
        const row = document.createElement('tr');
        row.innerHTML = `
          <td>${index + 1}</td>
          <td>${data.reference || '-'}</td>
          <td>${data.name}</td>
          <td>${data.date}</td>
          <td>${data.invoice}</td>
          <td>${data.type}</td>
          <td class="text-right">${formatNumber(data.qty, 2)}</td>
          <td class="text-right">${data.price.toLocaleString('en-US', { minimumFractionDigits: 4, maximumFractionDigits: 4 })}</td>
          <td class="text-right">${formatNumber(data.totalBefore)}</td>
          <td class="text-right">${formatNumber(data.vat)}</td>
          <td class="text-right">${formatNumber(data.totalAfter)}</td>
          <td class="text-right">${formatNumber(data.whtAmount)}</td>
          <td class="text-right">${formatNumber(data.netPay)}</td>
          <td>${data.mop}</td>
        `;
        tbody.appendChild(row);
      });
      
      // Scroll to registered list
      document.querySelector('#registeredTable').scrollIntoView({ behavior: 'smooth' });
    }

    function updateSummary() {
      // Calculate totals from savedData
      let totalLocalVAT = 0;
      let totalForeignVAT = 0;
      let totalGeneralVAT = 0;
      
      savedData.forEach(data => {
        if (data.type === 'Goods') {
          totalLocalVAT += data.vat;
        } else if (data.type === 'Services') {
          // This is a simplified example - you would need actual business logic
          // to determine foreign vs general expenses
          totalGeneralVAT += data.vat;
        }
      });
      
      // Update summary table
      const summaryBody = document.querySelector('.summary-table tbody');
      if (savedData.length > 0) {
        const month = document.getElementById('month').value;
        const year = document.getElementById('year').value;
        
        summaryBody.innerHTML = `
          <tr>
            <td>1</td>
            <td>${month}, ${year}</td>
            <td>Goods</td>
            <td class="text-right">${totalForeignVAT > 0 ? formatNumber(totalForeignVAT) : '-'}</td>
            <td class="text-right">${totalGeneralVAT > 0 ? formatNumber(totalGeneralVAT) : '-'}</td>
            <td class="text-right">${formatNumber(totalLocalVAT)}</td>
            <td class="text-right">${formatNumber(totalLocalVAT + totalForeignVAT + totalGeneralVAT)}</td>
          </tr>
        `;
      }
    }

    function printForm() {
      window.print();
    }
    
    function clearForm() {
      if (confirm('Are you sure you want to clear all form data? This cannot be undone.')) {
        // Clear input rows
        const tbody = document.querySelector('#vatTable tbody');
        while (tbody.rows.length > 1) {
          tbody.deleteRow(1);
        }
        
        // Clear the first row
        tbody.rows[0].querySelectorAll('input').forEach(input => {
          if (input.type !== 'button') input.value = '';
        });
        
        // Reset selects in first row
        tbody.rows[0].querySelectorAll('select').forEach(select => {
          select.selectedIndex = 0;
        });
        
        // Clear saved data
        savedData.length = 0;
        renderRegisteredList();
        
        // Reset summary table
        document.querySelector('.summary-table tbody').innerHTML = `
          <tr>
            <td>1</td>
            <td></td>
            <td></td>
            <td></td>
            <td></td>
            <td></td>
            <td></td>
          </tr>
        `;
        
        alert('Form cleared successfully.');
      }
    }
    
    function validateDateRange() {
      const fromDate = new Date(document.getElementById('fromDate').value);
      const toDate = new Date(document.getElementById('toDate').value);
      
      if (fromDate && toDate && fromDate > toDate) {
        alert('From date cannot be after To date');
        document.getElementById('toDate').value = '';
      }
    }

    // Initialize the form
    document.addEventListener('DOMContentLoaded', function() {
      // Set default dates
      const today = new Date();
      const firstDay = new Date(today.getFullYear(), today.getMonth(), 1);
      const lastDay = new Date(today.getFullYear(), today.getMonth() + 1, 0);
      
      document.getElementById('fromDate').valueAsDate = firstDay;
      document.getElementById('toDate').valueAsDate = lastDay;
      
      // Set current month
      const months = ['January', 'February', 'March', 'April', 'May', 'June', 
                     'July', 'August', 'September', 'October', 'November', 'December'];
      document.getElementById('month').value = months[today.getMonth()];
      
      updateRowNumbers();
    });
  </script>
</body>
</html>